
version: '3'
services:

  fancier_greeter_basic_greeter_ctr:
    build:
      context: fancier_greeter_basic_greeter_ctr
      dockerfile: ./Dockerfile
    hostname: fancier_greeter_basic_greeter_ctr
    expose:
     - "12345"
    ports:
     - "${FANCIER_GREETER_BASIC_GREETER_GRPC_BIND_ADDR?fancier_greeter__basic_greeter.grpc.bind_addr must be set by the calling environment}:12345"
    environment:
     - FANCIER_GREETER_BASIC_GREETER_GRPC_BIND_ADDR=0.0.0.0:12345
     - TRACING_AGENT_DIAL_ADDR=${TRACING_AGENT_DIAL_ADDR?tracing_agent.dial_addr must be set by the calling environment}
    restart: always

  fancier_greeter_ctr:
    build:
      context: fancier_greeter_ctr
      dockerfile: ./Dockerfile
    hostname: fancier_greeter_ctr
    expose:
     - "2000"
    ports:
     - "${FANCIER_GREETER_HTTP_BIND_ADDR?fancier_greeter.http.bind_addr must be set by the calling environment}:2000"
    environment:
     - FANCIER_GREETER_BASIC_GREETER_GRPC_DIAL_ADDR=fancier_greeter_basic_greeter_ctr:12345
     - FANCIER_GREETER_HTTP_BIND_ADDR=0.0.0.0:2000
     - TRACING_AGENT_DIAL_ADDR=${TRACING_AGENT_DIAL_ADDR?tracing_agent.dial_addr must be set by the calling environment}
    restart: always

